---
title: "Analyze MASSpy Output"
author: "Alicia Key"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load the libraries

```{r}
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(here)
```

## Load the data

```{r}
flux_sol <- read_csv(here("input", "flux_sol.csv"))
conc_sol <- read_csv(here("input", "conc_sol.csv"))
```

## Display head of the data

```{r}
head(flux_sol)
```

```{r}
head(conc_sol)
```

## Flux Operations

This section will operate on the flux dataframe.

### Pivot longer

```{r}
flux_long <- flux_sol %>%
  pivot_longer(-Time, names_to = "reaction", values_to = "flux_mM_per_hr")

head(flux_long)
```

### Find CVs of all fluxes

```{r}
flux_stats <- flux_long %>%
  group_by(reaction) %>%
  summarize(cv = sd(flux_mM_per_hr) / mean(flux_mM_per_hr)) %>%
  arrange(desc(cv))

head(flux_stats)
```
