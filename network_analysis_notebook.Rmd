---
title: "Network Analysis Notebook"
author: "Alicia Key"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries

```{r}
library(tidyverse)
```

## Load Functions

```{r}
source("simulation_functions.R")
```

## Run the simulation

```{r}
initial <- initial_times_and_conditions(length_minutes = 120)
input2_cutoff <- turn_input2_off_and_on(initial, 10, 60, cutoff_level = 0.0)
result <- run_euler(input2_cutoff)
```

## Plot the result

```{r}
result %>%
  select(-input1, -input2) %>%
  pivot_longer(-t_minutes, values_to = "concentration", names_to = "metabolite") %>%
  ggplot(aes(x = t_minutes, y = concentration, color = metabolite)) +
  geom_line(linewidth = 1)
```

